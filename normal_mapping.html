<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenGL ES SDK for Android: Normal Mapping</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function()
{ (i[r].q=i[r].q||[]).push(arguments)}
,i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-35797182-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="top_banner.bmp"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenGL ES SDK for Android
<span id="armdevcenter"><a href="https://developer.arm.com/">ARM Developer Center</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('normal_mapping.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Normal Mapping </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Basic Normal Mapping tutorial that uses Normal Maps</p>
<h1><a class="anchor" id="normalMappingIntroduction"></a>
Introduction</h1>
<p>One problem that comes up when doing mobile and indeed computer graphics is the balance between scene complexity and performance. To make a model look realistic it tends to need a vast amount of vertices and geometry. Unfortunately this can make the application run very slowly. Normal mapping is a method that allows a model to appear to have more complex geometry than in reality.</p>
<p>This works by combining simple geometry with the surface normals from a more complex version of the same geometry. First, we create the more complex geometry including the direction of all the surface normals. We then save these normals in a texture and apply them to your simple geometry to make it look more realistic. This tutorial will look at this technique.</p>
<h1><a class="anchor" id="normalMappingPrerequisites"></a>
Prerequisites</h1>
<p>This tutorial assumes you have read both and understood both the <a class="el" href="texture_cube.html">Texture Cube</a> and <a class="el" href="lighting.html">Lighting</a> examples. As you are going to be using techniques learned in both. You will need to load a normal map texture like in the texturing example and then light it using the techniques used in the lighting example.</p>
<h1><a class="anchor" id="normalMappingFileLoading"></a>
File Loading</h1>
<p>When we were looking at the simple texture example we hard coded the texture into our source code. This was fine for our example as a 3 x 3 texture worked well to illustrate the point of the tutorial. In the real world textures are much bigger and you wouldn't want to include these directly in the source code. Especially if you are using quite a few textures.</p>
<p>One way around this is to include the textures as assets into the apk file itself. That way the texture will get compressed with the apk and will always be available. This is preferred over placing the file on the Android filesystem somewhere as it includes an extra step for the user to do.</p>
<p>Placing assets into an apk is very simple. If you notice in your project directory structure, there is a folder called assets. Any files that you place in this folder will be compressed into the apk when building. The problem is trying to get them out again. We must do this in the Java side so we need to modify <a class="el" href="_normal_mapping_8java.html">NormalMapping.java</a></p>
<div class="fragment"><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String LOGTAG = <span class="stringliteral">&quot;NormalMapping&quot;</span>;</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String assetDirectory = null;</div>
<div class="line">    <span class="keyword">protected</span> TutorialView graphicsView;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> android.content.Context applicationContext = null;</div>
</div><!-- fragment --><p> The first thing we need to do is add two new members to our class. One is a String to where we want to store our application data. We don't want to hard code this as in future Android versions this location may change. The second member is an instance of the android.content.Context. We need this to be able to access the AssetManager in order to get our files back out the apk.</p>
<p>In our onCreate method we need to set these two new members and do a call to a new extractAsset function which will extract our texture from the apk and place it in the application's data location on the device.</p>
<div class="fragment"><div class="line">        applicationContext = getApplicationContext();</div>
<div class="line">        assetDirectory = applicationContext.getFilesDir().getPath() + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        extractAsset(<span class="stringliteral">&quot;normalMap256.raw&quot;</span>);</div>
</div><!-- fragment --><p> Our applicationContext is just initialised by calling the getApplicationContext function which is provided as a standard Android function. We then use it to see where we should store the applications files and store this in our string. After this we call our new extractAsset function with the name of the asset we want to extract. I think it is time we defined this function.</p>
<p>The idea of the function is simple, first check to see if the file we are trying to extract is on the filesystem. If it is then there is no further work needed as the file is already extracted. If not the function needs to continue and do some more work and extract it for us.</p>
<div class="fragment"><div class="line">    <span class="keyword">private</span> <span class="keywordtype">void</span> extractAsset(String assetName)</div>
<div class="line">    {</div>
<div class="line">        File fileTest = <span class="keyword">new</span> File(assetDirectory + assetName);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(fileTest.exists())</div>
<div class="line">        {</div>
<div class="line">            Log.d(LOGTAG,assetName +  <span class="stringliteral">&quot; already exists no extraction needed\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            Log.d(LOGTAG, assetName + <span class="stringliteral">&quot; doesn&#39;t exist extraction needed \n&quot;</span>);</div>
</div><!-- fragment --><p> To extract our file to the filesystem we need to start by creating a file that will serve as the extracted version. We have chosen to use the RandomAccessFile class to do this. We then need to get an instance of the AssetManager this involves using the applicationContext that we defined earlier. Note we also need to do this in a try catch block as some of the functions that we are going to use with the files can throw exceptions.</p>
<div class="fragment"><div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                RandomAccessFile out = <span class="keyword">new</span> RandomAccessFile(assetDirectory + assetName,<span class="stringliteral">&quot;rw&quot;</span>);</div>
<div class="line">                AssetManager am = applicationContext.getResources().getAssets();</div>
</div><!-- fragment --><p> We then read from the file and write to the output file using standard Java techniques. We use a InputStream to open the file in the AssetManager. Then we declare a buffer and fill it from the input stream. We then write that information out using the RandomAccessFile. Once this has finished we close both files and catch the exception that is all there is to it.</p>
<div class="fragment"><div class="line">                InputStream inputStream = am.open(assetName);</div>
<div class="line">                byte buffer[] = <span class="keyword">new</span> byte[1024];</div>
<div class="line">                <span class="keywordtype">int</span> count = inputStream.read(<a class="code" href="gl2ext_8h.html#a7fc54503e1a1cf98d128b839ebc0b4d0">buffer</a>, 0, 1024);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">while</span> (count &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    out.write(<a class="code" href="gl2ext_8h.html#a7fc54503e1a1cf98d128b839ebc0b4d0">buffer</a>, 0, <a class="code" href="gl2ext_8h.html#a619bc20e8198de3bd3f3d7fc34de66b2">count</a>);</div>
<div class="line">                    count = inputStream.read(<a class="code" href="gl2ext_8h.html#a7fc54503e1a1cf98d128b839ebc0b4d0">buffer</a>, 0, 1024);</div>
<div class="line">                }</div>
<div class="line">                out.close();</div>
<div class="line">                inputStream.close();</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span>(Exception e)</div>
<div class="line">            {</div>
<div class="line">                Log.e(LOGTAG, <span class="stringliteral">&quot;Failure in extractAssets(): &quot;</span> + e.toString() + <span class="stringliteral">&quot; &quot;</span> + assetDirectory+assetName);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>(fileTest.exists())</div>
<div class="line">            {</div>
<div class="line">                Log.d(LOGTAG,<span class="stringliteral">&quot;File Extracted successfully&quot;</span>);</div>
</div><!-- fragment --> <h1><a class="anchor" id="normalMappingModifyTextureToLoadFromFile"></a>
Loading the Texture</h1>
<p>Now that we have extracted all our files from the asset manager it is time to edit our texture loading function to load textures from files instead of hardcoded values. First of all instead of defining an array that will be our texture we need to just define a pointer that we want to fill with the data.</p>
<div class="fragment"><div class="line">GLuint <a class="code" href="tutorials_2_mipmapping_2jni_2_texture_8cpp.html#a71d2b07c832bea6efd324d3e6a1ca199">loadTexture</a>()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> GLuint <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a748ff5115c8b3b65daec06945c822353">textureId</a>;</div>
<div class="line">    theTexture = (GLubyte *)malloc(<span class="keyword">sizeof</span>(GLubyte) * <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a1427df84856073155ef2c02b11dd7046">TEXTURE_WIDTH</a> * <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a75434db7403d999b9acc501f74dc6e74">TEXTURE_HEIGHT</a> * <a class="code" href="tutorials_2_mipmapping_2jni_2_texture_8cpp.html#aa6547ba34c6932506460a32bac092cfe">CHANNELS_PER_PIXEL</a>);</div>
<div class="line"></div>
<div class="line">    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Generate a texture object. */</span></div>
<div class="line">    glGenTextures(1, &amp;textureId);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Activate a texture. */</span></div>
<div class="line">    glActiveTexture(GL_TEXTURE0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Bind the texture object. */</span></div>
<div class="line">    glBindTexture(GL_TEXTURE_2D, textureId);</div>
<div class="line"></div>
<div class="line">    FILE * theFile = fopen(<span class="stringliteral">&quot;/data/data/com.arm.malideveloper.openglessdk.normalmapping/files/normalMap256.raw&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(theFile == NULL)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="jni_2_astc_textures_8h.html#ae02538a80ad5fc009caec73487d11a8d">LOGE</a>(<span class="stringliteral">&quot;Failure to load the texture&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    fread(theTexture, <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a1427df84856073155ef2c02b11dd7046">TEXTURE_WIDTH</a> * <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a75434db7403d999b9acc501f74dc6e74">TEXTURE_HEIGHT</a> * <a class="code" href="tutorials_2_mipmapping_2jni_2_texture_8cpp.html#aa6547ba34c6932506460a32bac092cfe">CHANNELS_PER_PIXEL</a>, 1, theFile);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Load the texture. */</span></div>
<div class="line">    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a1427df84856073155ef2c02b11dd7046">TEXTURE_WIDTH</a>, <a class="code" href="tutorials_2_normal_mapping_2jni_2_texture_8cpp.html#a75434db7403d999b9acc501f74dc6e74">TEXTURE_HEIGHT</a>, 0, GL_RGB, GL_UNSIGNED_BYTE, theTexture);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Set the filtering mode. */</span></div>
<div class="line">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);</div>
<div class="line">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</div>
<div class="line"></div>
<div class="line">    free(theTexture);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a748ff5115c8b3b65daec06945c822353">textureId</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The start of the function is exactly the same as the previous texture loading example. The only difference is when it comes to opening the file. Note how for now we have hardcoded the path for the texture. Ideally we would pass this in from the Java side as a JString but this is beyond the scope of this tutorial.</p>
<p>Once we have opened the file we then malloc some space for it. As we are opening a raw file the data is presented exactly the same way as the texture example. Red component followed by green and then finally by blue each a byte in size. Our texture is 256 x 256 so we need to times this value by 3 because each pixel has 3 components. If you are using your own texture with different dimensions you need to edit this line.</p>
<p>We then read the texture into the space we just allocated again only reading 256 x 256 x 3 bytes. We then feed this information into glTexImage2D as before, and then we need to free the space that we allocated earlier as the texture will have been copied into the GPU.</p>
<h1><a class="anchor" id="normalMappingNormalMaps"></a>
Normal Maps</h1>
<p>As mentioned earlier we are going to increase the detail and complexity of our scene by using a normal map. A normal map is a regular texture but instead of defining what colour a pixel will be on screen, it determines what the surface normal will be for each pixel. The red, green and blue channels in the texture tell you the X, Y and Z components of the normal direction respectively.</p>
<p>To understand this better it's a good idea to look at the texture that is provided with this tutorial. Open the image with your favourite image editing software, so you can look at the colours and see what the colour components are at each pixel. For our example we have always left the Z coordinate to be fully on. The texture image has been provided below for your convenience.</p>
<div class="image">
<img src="normalMap256.png" alt="normalMap256.png"/>
</div>
<p>Note the bump mapping technique is really similar to this, the only difference is that a bump map texture is defined only in one channel. This then tells you a height value of a particular point in the map. With this you can then do some calculations in your fragment shader to achieve some really nice effects.</p>
<h1><a class="anchor" id="normalMappingTangentSpace"></a>
Tangent Space</h1>
<p>The only difficulty with using a normal map is it doesn't take into account the rotation of the object. In the lighting example we translated our normals by the model view matrix but we can't do this if we are loading from a texture. This presents a problem.</p>
<p>One solution to this problem is to move the eye vector and the light vector into something called the tangent space. A space can be defined with three axes that are orthogonal to each other. The tangent space is the space that has two axes on the face you are trying to render and the third coming out of the face. The axes coming out of the face is called the normal that we have previously discussed. Either one of the two remaining is known as the tangent and the one left is called the biNormal. This is a complicated concept and there are two ways that may help you understand:</p>
<ul>
<li>The first is to use your hand. Hold your hand in front of you and point your thumb up into the sky like you are giving someone a thumbs up. Extend your index finger all the way out so it is at 90 degrees to your thumb. Extend your middle thing half way so it is perpendicular to your index finger. Your three fingers should now represent a set of axes. If you imagine you are dealing with the front face of your cube then your middle finger would represent the normal. Either your thumb or your index finger is your tangent and the other is your biNormal. Now if you rotate your whole hand to represent the face you want to deal with you should get the set of axes that you require.</li>
<li>The second technique is to create a cube out of paper. Use a standard cube net and create the cube. Then place on each face of the cube two perpendicular arrows. Then place the cube down, on each side the arrows will show you the location of your tangent and biNormal. You already know the normal points out of the face. Note this also works really well for working out your texture coordinates.</li>
</ul>
<p>Now in our example we have defined the tangent and biNormal seperately. This is done to aid understanding of the concepts involved it is quite possible to work out the biNormal by using something called the cross product. If you prefer to do this don't pass the biNormal in as a parameter and add the appropriate line in your shader. More on this when we discuss the changes to the shader.</p>
<h1><a class="anchor" id="normalMappingTangentsNormal"></a>
Defining the Normals, Tangents and BiNormals.</h1>
<div class="fragment"><div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> <a class="code" href="_e_g_l_preserve_8h.html#a6a0fee23e187c9b7e76db49892845406">cubeVertices</a>[] = {-1.0f,  1.0f, -1.0f, <span class="comment">/* Back. */</span></div>
<div class="line">                           1.0f,  1.0f, -1.0f,</div>
<div class="line">                          -1.0f, -1.0f, -1.0f,</div>
<div class="line">                           1.0f, -1.0f, -1.0f,</div>
<div class="line">                          -1.0f,  1.0f,  1.0f, <span class="comment">/* Front. */</span></div>
<div class="line">                           1.0f,  1.0f,  1.0f,</div>
<div class="line">                          -1.0f, -1.0f,  1.0f,</div>
<div class="line">                           1.0f, -1.0f,  1.0f,</div>
<div class="line">                          -1.0f,  1.0f, -1.0f, <span class="comment">/* Left. */</span></div>
<div class="line">                          -1.0f, -1.0f, -1.0f,</div>
<div class="line">                          -1.0f, -1.0f,  1.0f,</div>
<div class="line">                          -1.0f,  1.0f,  1.0f,</div>
<div class="line">                           1.0f,  1.0f, -1.0f, <span class="comment">/* Right. */</span></div>
<div class="line">                           1.0f, -1.0f, -1.0f,</div>
<div class="line">                           1.0f, -1.0f,  1.0f,</div>
<div class="line">                           1.0f,  1.0f,  1.0f,</div>
<div class="line">                          -1.0f, 1.0f, -1.0f, <span class="comment">/* Top. */</span></div>
<div class="line">                          -1.0f, 1.0f,  1.0f,</div>
<div class="line">                           1.0f, 1.0f,  1.0f,</div>
<div class="line">                           1.0f, 1.0f, -1.0f,</div>
<div class="line">                          -1.0f, - 1.0f, -1.0f, <span class="comment">/* Bottom. */</span></div>
<div class="line">                          -1.0f,  -1.0f,  1.0f,</div>
<div class="line">                           1.0f, - 1.0f,  1.0f,</div>
<div class="line">                           1.0f,  -1.0f, -1.0f</div>
<div class="line">                         };</div>
<div class="line"></div>
<div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> normals[] =     {0.0f, 0.0f, -1.0f,            <span class="comment">/* Back */</span></div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,            <span class="comment">/* Front */</span></div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        -1.0f, 0.0, 0.0f,            <span class="comment">/* Left */</span></div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,             <span class="comment">/* Right */</span></div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,             <span class="comment">/* Top */</span></div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, -1.0f, 0.0f,            <span class="comment">/* Bottom */</span></div>
<div class="line">                        0.0f, -1.0f, 0.0f,</div>
<div class="line">                        0.0f, -1.0f, 0.0f,</div>
<div class="line">                        0.0f, -1.0f, 0.0f</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> colour[] =      {1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        1.0f, 1.0f, 0.0f,</div>
<div class="line">                        1.0f, 1.0f, 0.0f,</div>
<div class="line">                        1.0f, 1.0f, 0.0f,</div>
<div class="line">                        1.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 1.0f,</div>
<div class="line">                        0.0f, 1.0f, 1.0f,</div>
<div class="line">                        0.0f, 1.0f, 1.0f,</div>
<div class="line">                        0.0f, 1.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f, 1.0f</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a7037e042e765ea969e7899a6d7022c3f">tangents</a>[] =    {-1.0f, 0.0f, 0.0f,            <span class="comment">/* Back */</span></div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        -1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,                <span class="comment">/* Front */</span></div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,                <span class="comment">/* Left */</span></div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,                <span class="comment">/* Right */</span></div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,                <span class="comment">/* Top */</span></div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,                <span class="comment">/* Bottom */</span></div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f, 0.0f</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a4b4eb9511332eec378f38afd803ff6c3">biNormals</a>[] = {    0.0f, 1.0f, 0.0f,                <span class="comment">/* Back */</span></div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,                <span class="comment">/* Front */</span></div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,                <span class="comment">/* Left */</span></div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,                 <span class="comment">/* Right */</span></div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, 0.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,                <span class="comment">/* Top */</span></div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, -1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,                <span class="comment">/* Bottom */</span></div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, 1.0f</div>
<div class="line"></div>
<div class="line">};</div>
<div class="line"><a class="code" href="gl2ext_8h.html#a1ce320a06625b9dfdb4bd890e219d23c">GLfloat</a> textureCords[] = {1.0f, 1.0f, <span class="comment">/* Back. */</span></div>
<div class="line">                        0.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f,</div>
<div class="line">                        0.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, <span class="comment">/* Front. */</span></div>
<div class="line">                        1.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f, <span class="comment">/* Left. */</span></div>
<div class="line">                        0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f,</div>
<div class="line">                        1.0f, 1.0f,</div>
<div class="line">                        1.0f, 1.0f, <span class="comment">/* Right. */</span></div>
<div class="line">                        1.0f, 0.0f,</div>
<div class="line">                        0.0f, 0.0f,</div>
<div class="line">                        0.0f, 1.0f,</div>
<div class="line">                        0.0f, 1.0f, <span class="comment">/* Top. */</span></div>
<div class="line">                        0.0f, 0.0f,</div>
<div class="line">                        1.0f, 0.0f,</div>
<div class="line">                        1.0f, 1.0f,</div>
<div class="line">                        0.0f, 0.0f, <span class="comment">/* Bottom. */</span></div>
<div class="line">                        0.0f, 1.0f,</div>
<div class="line">                        1.0f, 1.0f,</div>
<div class="line">                        1.0f, 0.0f</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">GLushort indicies[] = {0, 3, 2, 0, 1, 3, 4, 6, 7, 4, 7, 5,  8, 9, 10, 8, 11, 10, 12, 13, 14, 15, 12, 14, 16, 17, 18, 16, 19, 18, 20, 21, 22, 20, 23, 22};</div>
</div><!-- fragment --><p> The vertices are just the same as they were in the <a class="el" href="simple_cube.html">Simple Cube</a> or the <a class="el" href="texture_cube.html">Texture Cube</a> example. 4 defined per face to generate a familiar cube. The normals are also defined so they are 4 per face. Unlike the lighting example they are all the same and all point perpendicular to the face. So the top face has 4 pointing in the positive Y direction. The back face has 4 pointing in the negative Z direction and so on.</p>
<p>Next are the colours; these are taken directly from the simple cube example and define a solid colour for each of the faces. After that is our first completely new section which is the tangents to each of the faces. Like the normals, 4 are defined per face and they are all the same. For the front face this is in the positive X direction, which as mentioned before, lies in the plane of the face and is perpendicular to the normal which is defined in positive Z direction. Keeping this in mind, the back face has a tangent in the negative X direction, the right and left faces have one in the negative Z and positive Z in respectively. The top and bottom are trickier and are both defined to have a tangent in the positive X direction.</p>
<p>To finish our space off we need to define the biNormal. This has to be perpendicular to both the normal and the tangent. Now for the front, back, right and left faces this can just be the positive Y direction. The top and bottom can’t do this unfortunately as their normal is the positive y and negative y axes respectively. This means we need to select the positive x direction instead to produce the same axes in the same orientation as the other sides. Again use the methods mentioned above if you need to solidify your understanding.</p>
<p>One extra thing to note is that there is a link between the texture coordinates that we have defined, and the way we have defined our axes. If we get this wrong then the texture can be displayed upside down, or the lighting can appear to be incorrect. This is also true for the texture example. However, as we didn't use normals or tangents in that example this was skipped past as it wasn't relevant at the time.</p>
<p>Finally the texture coordinates are defined to be the same as the texture coordinates in the TextureCube example.</p>
<h1><a class="anchor" id="normalMappingVertexShader"></a>
Vertex Shader</h1>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> glVertexShader[] =</div>
<div class="line">        <span class="stringliteral">&quot;attribute vec4 vertexPosition;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;attribute vec2 vertexTextureCord;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;attribute vec3 vertexNormal;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;attribute vec3 vertexColor; \n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;attribute vec3 vertexTangent;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;attribute vec3 vertexBiNormal;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec2 textureCord;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 varyingColor; \n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 inverseLightDirection;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 inverseEyeDirection;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;uniform mat4 projection;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;uniform mat4 modelView;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;void main()\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;{\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 worldSpaceVertex =(modelView * vertexPosition).xyz;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 transformedVertexNormal = normalize((modelView *  vec4(vertexNormal, 0.0)).xyz);&quot;</span></div>
<div class="line"></div>
<div class="line">        <span class="stringliteral">&quot;   inverseLightDirection = normalize(vec3(0.0, 0.0, 1.0));\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   inverseEyeDirection = normalize((vec3(0.0, 0.0, 1.0)- worldSpaceVertex ).xyz);\n&quot;</span></div>
<div class="line"></div>
<div class="line">        <span class="stringliteral">&quot;   gl_Position = projection * modelView * vertexPosition;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   textureCord = vertexTextureCord;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   varyingColor = vertexColor;\n&quot;</span></div>
<div class="line"></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 transformedTangent = normalize((modelView * vec4(vertexTangent, 0.0)).xyz);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 transformedBinormal = normalize((modelView * vec4(vertexBiNormal, 0.0)).xyz);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   mat3 tangentMatrix = mat3(transformedTangent, transformedBinormal, transformedVertexNormal);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   inverseLightDirection =inverseLightDirection * tangentMatrix;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   inverseEyeDirection = inverseEyeDirection * tangentMatrix;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>;</div>
</div><!-- fragment --><p> The vertex shader looks simpler than the vertex shader in the <a class="el" href="lighting.html">Lighting</a> tutorial. This is due to the fact that a lot of the calculations have been moved to the fragment shader. The first line in the main function creates a temporary variable that is equal to the current vertex that has been transformed by the modelView matrix. This is needed when working out the eye vector from the current vertex.</p>
<p>The next line transforms the vertex normal in much the same way you did in the lighting tutorial. Although all the complex normals we are going to use are defined in our normal map we still need to use the "real" vertex normal to create the matrix that will move our light and eye vectors into the tangent space.</p>
<p>The next two lines define our inverseLightDirection and inverseEyeDirection. The inverseLightDirection uses the same code as the <a class="el" href="lighting.html">Lighting</a> tutorial. As we are still only dealing with directional light we don't need to get a vector from the vertex to the light as all light is treated as being parallel direction vectors.</p>
<p>The three lines after this should be pretty simple stuff for us now. They set gl_Position to be exactly the same as numerous other tutorials and pass the texture coordinates and colours through to the fragment shader without being touched. After these lines we define the transformedTangent and the transformedBinormal. Remember how I said that we needed 3 things to convert our eye and light vectors into tangent space? Well we already have the normal so next we need to take the passed in both the tangent and biNormal and transform it by the modelview matrix.</p>
<p>Note if you want to work out the biNormal by using the cross product you should do the line here. So after transformedTangent you should write:</p>
<div class="fragment"><div class="line"><a class="code" href="structvec3.html">vec3</a> biNormal = cross(transformedVertexNormal, transformedTangent)</div>
</div><!-- fragment --><p>Then pass this in as a parameter to the tangent matrix. Note, the cross product function is built into OpenGL ES 2.0.</p>
<p>The final 3 lines of the vertex shader are responsible for converting the eyeVector and lightVector into tangent space. First we need to create a new transformation matrix this is made up of the tangent, bi normal and normal vectors we have created earlier. We then simply multiply the light and the eye by this new matrix in turn. That's all there is to it!!</p>
<h1><a class="anchor" id="normalMappingFragmentShader"></a>
Fragment Shader</h1>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#a19ae499a471bac9a17d303bf37311457">glFragmentShader</a>[] =</div>
<div class="line">        <span class="stringliteral">&quot;precision mediump float;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;uniform sampler2D texture;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec2 textureCord;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 varyingColor;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 inverseLightDirection;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 inverseEyeDirection;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;varying vec3 transformedVertexNormal;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;void main()\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;{\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 fragColor = vec3(0.0,0.0,0.0); \n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 normal = texture2D(texture, textureCord).xyz;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   normal = normalize(normal * 2.0 -1.0);&quot;</span></div>
<div class="line">        <span class="comment">/* Calculate the diffuse component. */</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 diffuseLightIntensity = vec3(1.0, 1.0, 1.0);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   float normalDotLight = max(0.0, dot(normal, inverseLightDirection));\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   fragColor += normalDotLight * varyingColor *diffuseLightIntensity;\n&quot;</span></div>
<div class="line">        <span class="comment">/* Calculate the ambient component. */</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 ambientLightIntensity = vec3(0.1, 0.1, 0.1);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   fragColor +=  ambientLightIntensity * varyingColor;\n&quot;</span></div>
<div class="line">        <span class="comment">/* Calculate the specular component. */</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 specularLightIntensity = vec3(1.0, 1.0, 1.0);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 vertexSpecularReflectionConstant = vec3(1.0, 1.0, 1.0);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   float shininess = 2.0;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   vec3 lightReflectionDirection = reflect(vec3(0) - inverseLightDirection, normal);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   float normalDotReflection = max(0.0, dot(inverseEyeDirection, lightReflectionDirection));\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   fragColor += pow(normalDotReflection, shininess) * vertexSpecularReflectionConstant * specularLightIntensity;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   /* Make sure the fragment colour is between 0 and 1. */&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   clamp(fragColor, 0.0, 1.0);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;   gl_FragColor = vec4(fragColor,1.0);\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>;</div>
</div><!-- fragment --><p> The fragment shader should look very familiar as much of the code came from the vertex shader of the Lighting tutorial. The first line of the main function sets the starting fragment colour and sets it to black or an absence of both light and colour.</p>
<p>The next two lines just get the normal from the normal map texture in much the same way we got a colour from a regular texture in the <a class="el" href="lighting.html">Lighting</a> example. From then on everything is near enough identical to the Lighting example. The diffuse is worked out and added to the frag colour, then the ambient and finally the specular light. This is then clamped to between 0.0 and 1.0 and is used to set gl_FragColor.</p>
<h1><a class="anchor" id="normalMappingExtraCode"></a>
Extra Code</h1>
<p>We are almost finished with our new Normal mapping example. We just need to tie the new attributes and uniforms in the shader with actual values from the main program.</p>
<div class="fragment"><div class="line">GLuint <a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#a83dd2521bc5a3e4938bf116aaa9b1328">vertexLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_mipmapping_2jni_2_native_8cpp.html#ad502762a6571721c6570cee5b389f56a">samplerLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#afbb3742f444abb100aa2b9743b5a86aa">projectionLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#ae185c1db995cde0f9bb86eccd6bb0f51">modelViewLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_mipmapping_2jni_2_native_8cpp.html#a99959c6dad05e7ca8d8878c766201f76">textureCordLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a0be21754a1abac17caa3708fcd8b2fdc">colorLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a748ff5115c8b3b65daec06945c822353">textureId</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_lighting_2jni_2_native_8cpp.html#accc2e61648e59c8edd75f96a09128793">vertexNormalLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a7c11ce6397943e1d47fdec3f928719a6">tangentLocation</a>;</div>
<div class="line">GLuint <a class="code" href="tutorials_2_normal_mapping_2jni_2_native_8cpp.html#a2bd586341cfb3f117cb18884be9f887c">biNormalLocation</a>;</div>
</div><!-- fragment --><p> Above is a list of all the location variables you will need to make this tutorial work. Starting with the vertexLocation which will store the location of the vertex attribute and finishing with our new tangentLocation which will store the location of our tangents. The code to set these locations to the correct values is presented below.</p>
<div class="fragment"><div class="line">    vertexLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexPosition&quot;</span>);</div>
<div class="line">    textureCordLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexTextureCord&quot;</span>);</div>
<div class="line">    projectionLocation = glGetUniformLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;projection&quot;</span>);</div>
<div class="line">    modelViewLocation = glGetUniformLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;modelView&quot;</span>);</div>
<div class="line">    samplerLocation = glGetUniformLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;texture&quot;</span>);</div>
<div class="line">    vertexNormalLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexNormal&quot;</span>);</div>
<div class="line">    colorLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexColor&quot;</span>);</div>
<div class="line">    tangentLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexTangent&quot;</span>);</div>
<div class="line">    biNormalLocation = glGetAttribLocation(<a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#acc375d345c9a0f0d601530103fe293af">glProgram</a>, <span class="stringliteral">&quot;vertexBiNormal&quot;</span>);</div>
</div><!-- fragment --><p> Finally here is the code to supply the locations above with their corresponding data. This should almost be coming second nature to you now.</p>
<div class="fragment"><div class="line">    glVertexAttribPointer(vertexLocation, 3, GL_FLOAT, GL_FALSE, 0, cubeVertices);</div>
<div class="line">    glEnableVertexAttribArray(vertexLocation);</div>
<div class="line">    glVertexAttribPointer(textureCordLocation, 2, GL_FLOAT, GL_FALSE, 0, textureCords);</div>
<div class="line">    glEnableVertexAttribArray(textureCordLocation);</div>
<div class="line">    glVertexAttribPointer(colorLocation, 3, GL_FLOAT, GL_FALSE, 0, colour);</div>
<div class="line">    glEnableVertexAttribArray(colorLocation);</div>
<div class="line">    glVertexAttribPointer(vertexNormalLocation, 3, GL_FLOAT, GL_FALSE, 0, normals);</div>
<div class="line">    glEnableVertexAttribArray(vertexNormalLocation);</div>
<div class="line">    glVertexAttribPointer(biNormalLocation, 3, GL_FLOAT, GL_FALSE, 0, biNormals);</div>
<div class="line">    glEnableVertexAttribArray(biNormalLocation);</div>
<div class="line">    glVertexAttribPointer(tangentLocation, 3, GL_FLOAT, GL_FALSE, 0, tangents);</div>
<div class="line">    glEnableVertexAttribArray(tangentLocation);</div>
<div class="line">    glUniformMatrix4fv(projectionLocation, 1, GL_FALSE,projectionMatrix);</div>
<div class="line">    glUniformMatrix4fv(modelViewLocation, 1, GL_FALSE, modelViewMatrix);</div>
</div><!-- fragment --><p> That is all there is to it go and enjoy your lovely normal mapped cube. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">
        <a class="copyright" href="http://www.arm.com/">(C) ARM Ltd. 2017</a>
    </li>
  </ul>
</div>
</body>
</html>
