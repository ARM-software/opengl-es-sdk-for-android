<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenGL ES SDK for Android: Integer Logic</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function()
{ (i[r].q=i[r].q||[]).push(arguments)}
,i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-35797182-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="top_banner.bmp"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenGL ES SDK for Android
<span id="armdevcenter"><a href="https://developer.arm.com/">ARM Developer Center</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('integerLogic.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Integer Logic </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The application simulates cellular automata phenomenon following Rule 30 using OpenGL ES 3.0.</p>
<h1><a class="anchor" id="integerLogicIntroduction"></a>
Introduction</h1>
<p>It's assumed that you have read and understood all of the mechanisms described in <a class="el" href="assetLoading.html">Asset Loading</a>,<a class="el" href="simpleTriangle.html">Simple Triangle</a> and <a class="el" href="textureCube.html">Texture Cube</a>.</p>
<h1><a class="anchor" id="integerLogicOverview"></a>
Overview</h1>
<div class="image">
<img src="IntegerLogic_android.png" alt="IntegerLogic_android.png"/>
<div class="caption">
The application simulates cellular automata phenomenon following Rule 30.</div></div>
<p> It uses two programs which operate on two textures used in a ping-pong manner. The first program takes the ping texture (<em>ping</em>) as the input and renders the output to a second texture (<em>pong</em>). Rendering in this case is performed by drawing one row at a time, with each row having height of 1 pixel and being of screen width. Excluding the first row, each row is drawn by reading one row above the currently processed one and applying the cellular automata rule. The first row's contents are set by the application. Since we cannot draw and read from the same texture at a single time, the drawing is performed one row at a time. After a row is drawn to texture <em>A</em>, the application binds texture <em>B</em> for drawing and uses texture <em>A</em> for reading the previous line. In the end, texture <em>A</em> contains even rows and texture <em>B</em> contains odd rows.</p>
<p>Having finished drawing lines to these two textures, we run another GL program that merges both textures into a single one by using texture <em>A</em> for even lines and texture <em>B</em> for odd ones.</p>
<p>In order to be able to render to a texture, we use a custom frame-buffer.</p>
<p>For the first run, the input line has only one pixel lit, so it generates the commonly known Rule 30 pattern. Then, every 5 seconds, textures are reset and the input is randomly generated.</p>
<h1><a class="anchor" id="integerLogicPrepareTextures"></a>
Prepare Textures</h1>
<p>As already mentioned in <a class="el" href="integerLogic.html#integerLogicOverview">Overview</a>, there are two texture objects being used in the application. So the first step is to generate them and prepare for use. We use a <em>ping-pong technique</em> so we will use the corresponding names for variables that will store texture IDs to make the algorithm more clearere.</p>
<p>Generate texture objects.</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGenTextures(2, textureIDs));</div><div class="line"></div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a0e33f6405777445e278c0830ecc1295b">pingTextureID</a> = textureIDs[0];</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a7b7330ddc22350ede05971c0ccce97cf">pongTextureID</a> = textureIDs[1];</div></div><!-- fragment --><p> Bind texture object to specific texture unit and set its property for the <em>ping</em> texture,</p>
<div class="fragment"><div class="line">    <span class="comment">/* Load ping texture data. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glActiveTexture(GL_TEXTURE0 + <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a32dc3beb67da127c3300ebd876d588a6">pingTextureUnit</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindTexture  (GL_TEXTURE_2D,</div><div class="line">                             <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a0e33f6405777445e278c0830ecc1295b">pingTextureID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexImage2D   (GL_TEXTURE_2D,</div><div class="line">                             0,</div><div class="line">                             GL_R8UI,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a>,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>,</div><div class="line">                             0,</div><div class="line">                             GL_RED_INTEGER,</div><div class="line">                             GL_UNSIGNED_BYTE,</div><div class="line">                             <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#ae8dd937e70e9bfb5c1549dd8c0c29d03">pingTextureData</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_WRAP_S,</div><div class="line">                             GL_CLAMP_TO_EDGE));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_WRAP_T,</div><div class="line">                             GL_CLAMP_TO_EDGE));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_MAG_FILTER,</div><div class="line">                             GL_NEAREST));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_MIN_FILTER,</div><div class="line">                             GL_NEAREST));</div></div><!-- fragment --><p> bind texture object to specific texture unit and set its property for the <em>pong</em> texture,</p>
<div class="fragment"><div class="line">    <span class="comment">/* Prepare pong texture object. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glActiveTexture(GL_TEXTURE0 + <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af0816a35226815ea754d219270408def">pongTextureUnit</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindTexture  (GL_TEXTURE_2D,</div><div class="line">                             <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a7b7330ddc22350ede05971c0ccce97cf">pongTextureID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexStorage2D (GL_TEXTURE_2D,</div><div class="line">                             1,</div><div class="line">                             GL_R8UI,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a>,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_WRAP_S,</div><div class="line">                             GL_CLAMP_TO_EDGE));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_WRAP_T,</div><div class="line">                             GL_CLAMP_TO_EDGE));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_MAG_FILTER,</div><div class="line">                             GL_NEAREST));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexParameteri(GL_TEXTURE_2D,</div><div class="line">                             GL_TEXTURE_MIN_FILTER,</div><div class="line">                             GL_NEAREST));</div></div><!-- fragment --><p> where texture units are being defined as</p>
<div class="fragment"><div class="line"><span class="comment">/* Texture unit used for configuring 2D texture binding for ping textures. */</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="gl2ext_8h.html#adda687347282e5405e89b4fc19a1f8e2">GLuint</a> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a32dc3beb67da127c3300ebd876d588a6">pingTextureUnit</a> = 0;</div><div class="line"><span class="comment">/* Texture unit used for configuring 2D texture binding for pong textures. */</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="gl2ext_8h.html#adda687347282e5405e89b4fc19a1f8e2">GLuint</a> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af0816a35226815ea754d219270408def">pongTextureUnit</a> = 1;</div></div><!-- fragment --><p> Please note, that only in the case of one of the textures (the <em>ping</em> one) is it already filled with data, in case of the <em>pong</em> one, there is only a data store being defined. The data used as an input for the <em>ping</em> texture is generated within the <em><a class="el" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a1abac88707c7a8f55bf8b92e234a4b73" title="Generates input for Rule 30 Cellular Automaton, setting a white dot in the top line of the texture on...">generateRule30Input()</a></em> call.</p>
<div class="fragment"><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a1abac88707c7a8f55bf8b92e234a4b73">generateRule30Input</a>   (<a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a> / 2,</div><div class="line">                           <a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a>,</div><div class="line">                           <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>,</div><div class="line">                           1,</div><div class="line">                          &amp;<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#ae8dd937e70e9bfb5c1549dd8c0c29d03">pingTextureData</a>);</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/* Please see the specification above. */</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a1abac88707c7a8f55bf8b92e234a4b73">generateRule30Input</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#ac20a0ffebf4c476650fcfa0633066f0e">xoffset</a>,</div><div class="line">                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a9a82cf3caff84cabc4598e2619faac17">width</a>,</div><div class="line">                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#aa352f2804b9902ac30769c00dde75d5f">height</a>,</div><div class="line">                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nComponents,</div><div class="line">                         GLvoid** textureData)</div><div class="line">{</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(textureData != NULL, <span class="stringliteral">&quot;Null data passed&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channelIndex = 0; channelIndex &lt; nComponents; ++channelIndex)</div><div class="line">    {</div><div class="line">        (*(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>**)textureData)[(height - 1) * width * nComponents + xoffset * nComponents + channelIndex] = 255;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p> In the application, we will use a <em>render to texture</em> technique, which is why we need to create a framebuffer object as well. Just to clarify: <em>rendering into texture</em> can be achieved by using (during a draw call) a framebuffer object (with the ID different from 0), to which there is a texture object bound.</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGenFramebuffers(1,</div><div class="line">                              &amp;<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#add5490a68e9c288c1e5832a256177219">framebufferID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindFramebuffer(GL_DRAW_FRAMEBUFFER,</div><div class="line">                               <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#add5490a68e9c288c1e5832a256177219">framebufferID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glDrawBuffers    (1,</div><div class="line">                               offscreenFBODrawBuffers));</div></div><!-- fragment --><p> Then, if a framebuffer object is bound,</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindFramebuffer(GL_DRAW_FRAMEBUFFER, <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#add5490a68e9c288c1e5832a256177219">framebufferID</a>));</div></div><!-- fragment --><p> we can call one of the functions shown below to indicate, in which texture object the result of rendering will be stored.</p>
<div class="fragment"><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER,</div><div class="line">                                            GL_COLOR_ATTACHMENT0,</div><div class="line">                                            GL_TEXTURE_2D,</div><div class="line">                                            <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a0e33f6405777445e278c0830ecc1295b">pingTextureID</a>,</div><div class="line">                                            0) );</div></div><!-- fragment --><div class="fragment"><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER,</div><div class="line">                                            GL_COLOR_ATTACHMENT0,</div><div class="line">                                            GL_TEXTURE_2D,</div><div class="line">                                            <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a7b7330ddc22350ede05971c0ccce97cf">pongTextureID</a>,</div><div class="line">                                            0));</div></div><!-- fragment --><p> If we are no longer interested in rendering into a texture object and would like the rendering result to be displayed on screen, we need to use the default framebuffer object, which means we have to call</p>
<div class="fragment"><div class="line"><a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0));</div></div><!-- fragment --><h1><a class="anchor" id="integerLogicProgramObjects"></a>
Program objects</h1>
<p>In the application, we are using two program objects: the first one is responsible for generating data accordingly to <em>Rule 30</em>, while the second one is used to merging the calculated data and display the result on screen. The main mechanism of generating program objects looks like the following (the idea is shown for the first program object):</p>
<ol type="1">
<li>Create program object ID; <div class="fragment"><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a> = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glCreateProgram());</div></div><!-- fragment --></li>
<li>Create shader objects' IDs (should be called twice for <em>shaderType</em> equal to <em>GL_FRAGMENT_SHADER</em> and <em>GL_VERTEX_SHADER</em>); <div class="fragment"><div class="line">        *shaderObjectIdPtr = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glCreateShader(shaderType));</div></div><!-- fragment --></li>
<li>Set shader source; <div class="fragment"><div class="line">        <a class="code" href="gl2ext_8h.html#a5dfa7628a601bf72d36273e52495a1db">strings</a>[0]         = <a class="code" href="tutorials_2_asset_loading_2jni_2_native_8cpp.html#aceb8b27cd7d369c524624ede81a1299e">loadShader</a>(filename);</div></div><!-- fragment --><div class="fragment"><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glShaderSource(*shaderObjectIdPtr, 1, <a class="code" href="gl2ext_8h.html#a5dfa7628a601bf72d36273e52495a1db">strings</a>, NULL));</div></div><!-- fragment --></li>
<li>Compile shader (it's always a good idea to check, whether the compilation succeeded: <em>GL_COMPILE_STATUS</em> set to <em>GL_TRUE</em>; <div class="fragment"><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glCompileShader(*shaderObjectIdPtr));</div></div><!-- fragment --><div class="fragment"><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetShaderiv(*shaderObjectIdPtr, GL_COMPILE_STATUS, &amp;compileStatus));</div></div><!-- fragment --></li>
<li>Attach shaders to program object; <div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glAttachShader(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, vertexRule30ShaderID));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glAttachShader(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, fragmentRule30ShaderID));</div></div><!-- fragment --></li>
<li>Link program object; <div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glLinkProgram(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>));</div></div><!-- fragment --></li>
<li>Use program. <div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUseProgram(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>) );</div></div><!-- fragment --> The next thing to do is to retrieve locations of the uniforms and attributes that are used in the shaders. This can be achieved as shown below.</li>
</ol>
<div class="fragment"><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputNeighbourLocation      = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetUniformLocation(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;inputNeighbour&quot;</span>)      );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputTextureLocation        = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetUniformLocation(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;inputTexture&quot;</span>)        );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputVerticalOffsetLocation = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetUniformLocation(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;inputVerticalOffset&quot;</span>) );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.mvpMatrixLocation           = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetUniformLocation(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;mvpMatrix&quot;</span>)           );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.positionLocation            = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetAttribLocation (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;position&quot;</span>)            );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.texCoordLocation            = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetAttribLocation (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;vertexTexCoord&quot;</span>)      );</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.verticalOffsetLocation      = <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGetUniformLocation(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>, <span class="stringliteral">&quot;verticalOffset&quot;</span>)      );</div></div><!-- fragment --><p> It's always a good idea to verify whether the attributes and uniforms are considered as active within the program object. This is why we need to check the returned location value (-1 location value means that the attribute or the uniform has not been found).</p>
<div class="fragment"><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputNeighbourLocation      != -1, <span class="stringliteral">&quot;Could not find location of a uniform in rule30 program: inputNeighbour&quot;</span>     );</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputTextureLocation        != -1, <span class="stringliteral">&quot;Could not find location of a uniform in rule30 program: inputTexture&quot;</span>       );</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputVerticalOffsetLocation != -1, <span class="stringliteral">&quot;Could not find location of a uniform in rule30 program: inputVerticalOffset&quot;</span>);</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.mvpMatrixLocation           != -1, <span class="stringliteral">&quot;Could not find location of a uniform in rule30 program: mvpMatrix&quot;</span>          );</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.positionLocation            != -1, <span class="stringliteral">&quot;Could not find location of an attribute in rule30 program: position&quot;</span>        );</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.texCoordLocation            != -1, <span class="stringliteral">&quot;Could not find location of an attribute in rule30 program: vertexTexCoord&quot;</span>  );</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.verticalOffsetLocation      != -1, <span class="stringliteral">&quot;Could not find location of a uniform in rule30 program: verticalOffset&quot;</span>     );</div></div><!-- fragment --><p> Now, if you are interested in setting values for the attributes, and we know you are and would like to set quad coordinates and texture UVs, it's enough to prepare a <em><a class="el" href="struct_vertex.html">Vertex</a> Array Object</em>.</p>
<p>First of all, create the object</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGenVertexArrays(1, &amp;<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#afb7470def54836da822efa8ff6236317">lineVAOID</a>));</div></div><!-- fragment --><p> and bind it.</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindVertexArray(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#afb7470def54836da822efa8ff6236317">lineVAOID</a>));</div></div><!-- fragment --><p> Now, when a vertex array object became active, we can set the input data for it. It's achieved by using array buffer objects.</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glGenBuffers(4, boIDs));</div><div class="line"></div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a33921a9e7fff89914133990fcf0097b4">linePositionBOID</a> = boIDs[0];</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af270111710ead48e9e4439f6bf77d692">lineUVBOID</a>       = boIDs[1];</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a737e1c376e54abe11ca08b4e13a55a1f">quadPositionBOID</a> = boIDs[2];</div><div class="line">    <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af7c950b72059e3eda0a51bc8dcc79c37">quadUVBOID</a>       = boIDs[3];</div></div><!-- fragment --><p> Please note that in this section we are describing only one program object, so we will discuss the usage of the first two buffer objects only (<em>linePositionBOID</em> and <em>lineUVBOID</em>).</p>
<p>Fill one of the buffer objects with quad coordinates data.</p>
<div class="fragment"><div class="line">    <span class="comment">/* Fill buffers with line vertices attribute data. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindBuffer             (GL_ARRAY_BUFFER,</div><div class="line">                                       <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a33921a9e7fff89914133990fcf0097b4">linePositionBOID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBufferData             (GL_ARRAY_BUFFER,</div><div class="line">                                       <span class="keyword">sizeof</span>(<a class="code" href="namespace_mali_s_d_k.html#aa12503e3827206bde253aad7756ed36b">lineVertices</a>),</div><div class="line">                                       <a class="code" href="namespace_mali_s_d_k.html#aa12503e3827206bde253aad7756ed36b">lineVertices</a>,</div><div class="line">                                       GL_STATIC_DRAW));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glVertexAttribPointer    (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.positionLocation,</div><div class="line">                                       4,</div><div class="line">                                       GL_FLOAT,</div><div class="line">                                       GL_FALSE,</div><div class="line">                                       0,</div><div class="line">                                       0));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glEnableVertexAttribArray(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.positionLocation));</div></div><!-- fragment --><p> Fill the second one with texture UVs data.</p>
<div class="fragment"><div class="line">    <span class="comment">/* Fill buffers with line U/V attribute data. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindBuffer             (GL_ARRAY_BUFFER,</div><div class="line">                                       <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af270111710ead48e9e4439f6bf77d692">lineUVBOID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBufferData             (GL_ARRAY_BUFFER,</div><div class="line">                                       <span class="keyword">sizeof</span>(<a class="code" href="namespace_mali_s_d_k.html#a88399755522ca80945c6a286bdaa72bd">lineTextureCoordinates</a>),</div><div class="line">                                       <a class="code" href="namespace_mali_s_d_k.html#a88399755522ca80945c6a286bdaa72bd">lineTextureCoordinates</a>,</div><div class="line">                                       GL_STATIC_DRAW));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glVertexAttribPointer    (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.texCoordLocation,</div><div class="line">                                       2,</div><div class="line">                                       GL_FLOAT,</div><div class="line">                                       GL_FALSE,</div><div class="line">                                       0,</div><div class="line">                                       0));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glEnableVertexAttribArray(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.texCoordLocation));</div></div><!-- fragment --><p> The important thing you can find above is the fact that we are binding the attribute location with a specific input data set by calling <em>glVertexAttribPointer()</em>.</p>
<p>If you would like to use the specific attributes input data during a draw call, you should remember to make the required vertex array object active for the draw call by calling <em>glBindVertexArray()</em>.</p>
<p>If you now would want to set data for the uniforms, you should call one of <em>glUniform()</em> family function, as the examples shown below. The function that should be used depends on the uniform type. If the uniform is of a matrix4x4 type, we should call <em>glUniformMatrix4fv()</em>, a single float value: <em>glUniform1f()</em>, a texture sampler: <em>glUniform1i()</em>. If a uniform value is constant during the rendering process, we can set it once, if it's changing we should call the specific <em>glUniform()</em> function every time we want to update the uniform value.</p>
<div class="fragment"><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniformMatrix4fv(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.mvpMatrixLocation,</div><div class="line">                                1,</div><div class="line">                                GL_FALSE,</div><div class="line">                                <a class="code" href="tutorials_2_foveated_rendering_2jni_2_native_8cpp.html#add07c9136bbcc487663aa0cd87c44b2e">modelViewProjectionMatrix</a>.getAsArray()));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniform1f       (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputNeighbourLocation,</div><div class="line">                                1.0f / <a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a>) );</div></div><!-- fragment --> <h1><a class="anchor" id="integerLogicRendering"></a>
Perform the rendering</h1>
<p>The algorithm is based on the two main steps:</p><ol type="1">
<li>Generating data (rendering into texture)</li>
<li>Rendering textures on the screen</li>
</ol>
<p>The first step is considered as follows: we want to render a single row then, depending on the first row, we want to draw a second row and so on, till the whole screen is rendered. The problem is that, we cannot read from and render to the same texture object at the same time. This is why we need two texture objects, each of which will store the even or odd lines of data. So it looks like described below: we render the first row and store the result in the <em>ping</em> texture. Then we want to render a second line based on the data in the first one: in the program object we sample the <em>ping</em> texture and based on the retrieved data, we are generating the current line and store the result in the <em>pong</em> texture. Then, during third line rendering, we use <em>pong</em> texture as an input and store data in the <em>ping</em> texture. It seems to be complicated, however the concept is very simple and is shown in the code presented below. Please note that for each iteration, the input and output textures are switched. The input texture is updated by calling <em>glUniform1i()</em> and the output texture by calling <em>glFramebufferTexture2D()</em>.</p>
<div class="fragment"><div class="line"><span class="comment">/* Please see the specification above. */</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a6c2a5bd6759da0e877af9a3d18d9bd8e">performOffscreenRendering</a>()</div><div class="line">{</div><div class="line">    <span class="comment">/* Offset of the input line passed to the appropriate uniform. */</span></div><div class="line">    <span class="keywordtype">float</span> inputVerticalOffset = 0.0f;</div><div class="line"></div><div class="line">    <span class="comment">/* Activate the first program. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUseProgram(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aef2570404403f4843d468501df4b26f4">rule30ProgramID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindVertexArray(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#afb7470def54836da822efa8ff6236317">lineVAOID</a>));</div><div class="line"></div><div class="line">    <span class="comment">/* [Bind the framebuffer object] */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindFramebuffer(GL_DRAW_FRAMEBUFFER, <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#add5490a68e9c288c1e5832a256177219">framebufferID</a>));</div><div class="line">    <span class="comment">/* [Bind the framebuffer object] */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Render each line, beginning from the 2nd one, using the input from the previous line.*/</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a1675d9d7bb68e1657ff028643b4037e3">y</a> = 1; <a class="code" href="gl2ext_8h.html#a1675d9d7bb68e1657ff028643b4037e3">y</a> &lt;= <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>; ++<a class="code" href="gl2ext_8h.html#a1675d9d7bb68e1657ff028643b4037e3">y</a>)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Even lines should be taken from the ping texture, odd from the pong. */</span></div><div class="line">        <span class="keywordtype">bool</span>  isEvenLineBeingRendered = (<a class="code" href="gl2ext_8h.html#a1675d9d7bb68e1657ff028643b4037e3">y</a> % 2 == 0) ? (<span class="keyword">true</span>) : (<span class="keyword">false</span>);</div><div class="line">        <span class="comment">/* Vertical offset of the currently rendered line. */</span></div><div class="line">        <span class="keywordtype">float</span> verticalOffset          = (<a class="code" href="hiz__cull_8cs.html#a2ab77c89eb79b49ccd22bb1b2ad48bf1">float</a>) <a class="code" href="gl2ext_8h.html#a1675d9d7bb68e1657ff028643b4037e3">y</a> / (<span class="keywordtype">float</span>) <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>;</div><div class="line"></div><div class="line">        <span class="comment">/* Pass data to uniforms. */</span></div><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniform1f(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.verticalOffsetLocation,      verticalOffset));</div><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniform1f(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputVerticalOffsetLocation, inputVerticalOffset));</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (isEvenLineBeingRendered)</div><div class="line">        {</div><div class="line">            <span class="comment">/* [Bind ping texture to the framebuffer] */</span></div><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER,</div><div class="line">                                            GL_COLOR_ATTACHMENT0,</div><div class="line">                                            GL_TEXTURE_2D,</div><div class="line">                                            <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a0e33f6405777445e278c0830ecc1295b">pingTextureID</a>,</div><div class="line">                                            0) );</div><div class="line">            <span class="comment">/* [Bind ping texture to the framebuffer] */</span></div><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniform1i           (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputTextureLocation,</div><div class="line">                                            pongTextureUnit) );</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <span class="comment">/* [Bind pong texture to the framebuffer] */</span></div><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER,</div><div class="line">                                            GL_COLOR_ATTACHMENT0,</div><div class="line">                                            GL_TEXTURE_2D,</div><div class="line">                                            <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a7b7330ddc22350ede05971c0ccce97cf">pongTextureID</a>,</div><div class="line">                                            0));</div><div class="line">            <span class="comment">/* [Bind pong texture to the framebuffer] */</span></div><div class="line">            <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUniform1i           (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#af9fe91d3eb8cf0f1f68ece6c1f2e5b96">rule30ProgramLocations</a>.inputTextureLocation,</div><div class="line">                                            pingTextureUnit) );</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">/* Drawing a horizontal line defined by 2 vertices. */</span></div><div class="line">        <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glDrawArrays(GL_LINES, 0, 2));</div><div class="line"></div><div class="line">        <span class="comment">/* Update the input vertical offset after the draw call, so it points to the previous line. */</span></div><div class="line">        inputVerticalOffset = verticalOffset;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Unbind the framebuffer. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0));</div><div class="line">}</div></div><!-- fragment --><p> When this step is completed, we are ready to perform the second step. The main idea here is to take those two textures: the <em>ping</em> and the <em>pong</em> ones and merge them as shown below. Please note that the default framebuffer object is made active, which means the result will be shown on screen.</p>
<div class="fragment"><div class="line"><span class="comment">/* Please see the specification above. */</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#aabe3bfc2dfc2674050a7d78e04f5addc">renderToBackBuffer</a>()</div><div class="line">{</div><div class="line">    <span class="comment">/* Activate the second program. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glUseProgram     (<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#ad1aa5cad422ddad8ae84847c20782a08">mergeProgramID</a>));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glBindVertexArray(<a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a6938357c9e4c505696bb367551bf5e4a">quadVAOID</a>));</div><div class="line"></div><div class="line">    <span class="comment">/* Draw a quad as a triangle strip defined by 4 vertices. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glDrawArrays(GL_TRIANGLE_STRIP, 0, 4));</div><div class="line">}</div></div><!-- fragment --><p> In the application we wanted to issue the algorithm many times based on the different input data. For the first time, we use the data generated as described in the previous section <a class="el" href="integerLogic.html#integerLogicPrepareTextures">Prepare Textures</a>. For each following iteration we use the data generated with the algorithm presented below.</p>
<div class="fragment"><div class="line"><span class="comment">/* Please see the specification above. */</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#a1abac88707c7a8f55bf8b92e234a4b73">generateRule30Input</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> width,</div><div class="line">                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> height,</div><div class="line">                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nComponents,</div><div class="line">                         GLvoid**     textureData)</div><div class="line">{</div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2common_8h.html#a9a90e23f0f81ce2fdf8c10979e6917fb">ASSERT</a>(textureData != NULL, <span class="stringliteral">&quot;Null data passed&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texelIndex = 0; texelIndex &lt; <a class="code" href="gl2ext_8h.html#a9a82cf3caff84cabc4598e2619faac17">width</a>; ++texelIndex)</div><div class="line">    {</div><div class="line">        <span class="keywordtype">bool</span> setWhite = (rand() % 2 == 0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (setWhite)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channelIndex = 0; channelIndex &lt; nComponents; ++channelIndex)</div><div class="line">            {</div><div class="line">                (*(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>**)textureData)[(height - 1) * width * nComponents + texelIndex * nComponents + channelIndex] = 255;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p> and substitute the <em>ping</em> texture data with the new one by calling</p>
<div class="fragment"><div class="line">    <span class="comment">/* Since texture objects have already been created, we can substitute ping image using glTexSubImage2D call.</span></div><div class="line"><span class="comment">     * Pong texture does not require reset, because its content depends entirely on the first line of the ping texture. */</span></div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glActiveTexture(GL_TEXTURE0));</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a410114caf210cb21e6c1701f04eb102d">GL_CHECK</a>(glTexSubImage2D(GL_TEXTURE_2D,</div><div class="line">                             0,</div><div class="line">                             0,</div><div class="line">                             0,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#aa61000540636bfdc4c9f27045ab84ce9">windowWidth</a>,</div><div class="line">                             <a class="code" href="_cube_8cpp.html#af140802328ffe8a45749114b1c5a2056">windowHeight</a>,</div><div class="line">                             GL_RED_INTEGER,</div><div class="line">                             GL_UNSIGNED_BYTE,</div><div class="line">                             <a class="code" href="tutorials_2_integer_logic_2jni_2_native_8cpp.html#ae8dd937e70e9bfb5c1549dd8c0c29d03">pingTextureData</a>));</div></div><!-- fragment --> <div class="image">
<img src="IntegerLogic_result.png" alt="IntegerLogic_result.png"/>
<div class="caption">
The result of first and second pass.</div></div>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">
        <a class="copyright" href="http://www.arm.com/">(C) ARM Ltd. 2017</a>
    </li>
  </ul>
</div>
</body>
</html>
