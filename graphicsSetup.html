<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenGL ES SDK for Android: Graphics Setup</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function()
{ (i[r].q=i[r].q||[]).push(arguments)}
,i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-35797182-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="top_banner.bmp"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenGL ES SDK for Android
<span id="armdevcenter"><a href="https://developer.arm.com/">ARM Developer Center</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('graphicsSetup.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Graphics Setup </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Setting up your application ready for graphics</p>
<h1><a class="anchor" id="graphicsSetupIntroduction"></a>
Introduction</h1>
<p>The source for this sample can be found in the folder of the SDK.</p>
<p>This tutorial will take the native application code that you generated in the <a class="el" href="firstNative.html">First Android Native Application</a> tutorial and add the necessary code to it in order to run OpenGL ES graphics. Although this tutorial will not produce anything new on the screen it will form the basis of all tutorials to come and will make explaining concepts in the next few tutorials much easier.</p>
<h1><a class="anchor" id="graphicsSetupApplicationFlow"></a>
Application Flow</h1>
<p>Just before we begin we will revisit the basic application flow and show where the graphics sections of code fit in.</p>
<ul>
<li>The application will start and control will be immediately passed to the Activity onCreate Function.</li>
<li>This function will create an instance of your View class and then will set the display to this View class.</li>
<li>On creation the View class will call an initialization function. This function will setup the surface to be rendered too. This involves setting an EGLContextFactory, setting an EGLConfiguration and then setting a Renderer.</li>
<li>Your renderer has two important functions. One is called when the surface size is either created or changed. The second is called every time a new frame is ready to be drawn. These functions typically reference functions that are written in the native side of your application. It does this by using a different class that holds function prototypes of all your native functions.</li>
<li>The native side then takes over and will render your scene.</li>
</ul>
<h1><a class="anchor" id="graphicsSetupNewProject"></a>
Creating a New Project</h1>
<p>We will be using the code created on a previous project a starting point for this project. So either copy the project or create a completely new project and include the source files from the previous project. The project should be called <b>GraphicsSetup</b> and the package name should be called <b><a class="el" href="namespacecom_1_1arm_1_1malideveloper_1_1openglessdk_1_1graphicssetup.html">com.arm.malideveloper.openglessdk.graphicssetup</a></b> Finally the activity class (previously <em><a class="el" href="_first_native_8java.html">FirstNative.java</a></em>) should be renamed <b><a class="el" href="_simple_triangle_8java.html">SimpleTriangle.java</a></b> using Eclipse (this ensures references to the activity get updated elsewhere in the project).</p>
<h1><a class="anchor" id="graphicsSetupAppropriateFiles"></a>
Creating the Appropriate Files for our Project</h1>
<p>This application will have three Java files and one C file. This means that we need to add one more file to our project called TutorialView.java. So right click on the project name GraphicsSetup and select <em>New -&gt; File</em>. From the directory structure that appears navigate to GraphicsSetup-&gt;src-&gt;com-&gt;arm-&gt;malideveloper-&gt;openglessdk-&gt;graphicssetup* and then enter the filename <b>TutorialView.java</b> and then click <em>Finish</em>. TutorialView.java should now be added to the same location as <a class="el" href="_graphics_setup_8java.html">GraphicsSetup.java</a>. This is the only file you need to create. The rest of this tutorial will go through all the files explaining what needs to be added.</p>
<h1><a class="anchor" id="graphicsSetupGraphicsSetup"></a>
GraphicsSetup Class</h1>
<p>None of the imports changed so there is no need to repeat that code. There is a new class member that is an instance of TutorialView. In Android any on screen elements are called views. As there isn't one that already defined that meets all of our requirements we need to define a new one in another class. This will inherit from GLSurfaceView and will be where our graphics will eventually get displayed.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>GraphicsSetup <span class="keyword">extends</span> Activity</div><div class="line">{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String LOGTAG = <span class="stringliteral">&quot;GraphicsSetup&quot;</span>;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> TutorialView graphicsView;</div></div><!-- fragment --><p> The onCreate method should be mostly the same as we had before except we want to create a new instance of TutorialView and assign it to the graphicsView variable. We then want to set the current content to be this new view. Meaning that the view that Android focuses on is the new Tutorialview we create.</p>
<div class="fragment"><div class="line">    @Override <span class="keyword">protected</span> <span class="keywordtype">void</span> onCreate(Bundle savedInstanceState)</div><div class="line">    {</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">        Log.i(LOGTAG, <span class="stringliteral">&quot;Creating New Tutorial View&quot;</span>);</div><div class="line">        graphicsView = <span class="keyword">new</span> TutorialView(getApplication());</div><div class="line">        setContentView(graphicsView);</div><div class="line">    }</div></div><!-- fragment --><p> Now for the onPause and onResume methods we do the same as before and call the super class on each of the functions so that the application can pause and resume correctly. We also need to call our new graphicsView onPause() and onResume() method appropriately. So that when the application needs to pause the graphics are paused as well.</p>
<div class="fragment"><div class="line">    @Override <span class="keyword">protected</span> <span class="keywordtype">void</span> onPause()</div><div class="line">    {</div><div class="line">        super.onPause();</div><div class="line">        graphicsView.onPause();</div><div class="line">    }</div><div class="line"></div><div class="line">    @Override <span class="keyword">protected</span> <span class="keywordtype">void</span> onResume()</div><div class="line">    {</div><div class="line">        super.onResume();</div><div class="line">        graphicsView.onResume();</div><div class="line">    }</div></div><!-- fragment --><p> That is all the changes we will do to GraphicsSetup.</p>
<h1><a class="anchor" id="graphicsSetupTutorialView"></a>
TutorialView Class</h1>
<p>It is time to create our one new file for this tutorial. As mentioned before the TutorialView is the view that will contain all of our graphics. We need to do quite a lot here. We need to get a configuration for the surface we will draw to and we will need to set the context up correctly for OpenGL ES 2.0. More information will be given in the relevant sections.</p>
<div class="fragment"><div class="line"><span class="keyword">package </span>com.arm.malideveloper.openglessdk.graphicssetup;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.opengl.GLSurfaceView;</div><div class="line"><span class="keyword">import</span> javax.microedition.khronos.egl.EGL10;</div><div class="line"><span class="keyword">import</span> javax.microedition.khronos.egl.EGLConfig;</div><div class="line"><span class="keyword">import</span> javax.microedition.khronos.egl.EGLContext;</div><div class="line"><span class="keyword">import</span> javax.microedition.khronos.egl.EGLDisplay;</div><div class="line"><span class="keyword">import</span> javax.microedition.khronos.opengles.GL10;</div></div><!-- fragment --><p> Here we have the standard logging header as before but we also need to include the graphics headers. Earlier we mentioned that our view was going to derive from GLSurfaceView so we need to import that as well as other headers specific to EGL and OpenGL ES. Including the EGLContext and configurations that have been briefly mentioned.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>TutorialView <span class="keyword">extends</span> GLSurfaceView</div><div class="line">{</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> redSize = 8;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> greenSize = 8;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> blueSize = 8 ;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> alphaSize = 8;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> depthSize = 16;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> sampleSize = 4;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> stencilSize = 0;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span>[] <a class="code" href="gl2ext_8h.html#ac783c2a5a0d42f36a33959f6a34ae0ba">value</a> = <span class="keyword">new</span> <span class="keywordtype">int</span> [1];</div></div><!-- fragment --><p> These lines above are member variables to the class. When setting up your surface for all of your graphics to run on you need to specify a series of parameters. One of the most important is what format you want want the surface to be in. We are going to go for a surface that is know as RGBA 8888. This means that we are going to use full 32-bit colour made up of 8-bits red, 8-bits green, 8-bits blue and 8-bits alpha.</p>
<p>We will also set the depth buffer size to 16-bits. This will be needed in later tutorials to make sure that objects are displayed in the right order. Sample size is to do with enabling Anti Aliasing. As you get 4x Anti Aliasing almost for free on a Mali platform, we will enable it. The stencil buffer is an advanced concept so for now we are disabling by setting it to 0.</p>
<div class="fragment"><div class="line">    <span class="keyword">public</span> TutorialView(Context context)</div><div class="line">    {</div><div class="line">        super(context);</div><div class="line"></div><div class="line">        setEGLContextFactory(<span class="keyword">new</span> ContextFactory());</div><div class="line"></div><div class="line">        setEGLConfigChooser(<span class="keyword">new</span> ConfigChooser());</div><div class="line"></div><div class="line">        setRenderer(<span class="keyword">new</span> Renderer());</div><div class="line">    }</div></div><!-- fragment --><p> This section of code is the constructor for our new View class. The first thing we do is again call the super constructor to take care of all the setup that we don't want to get directly involved in. The next two calls are to do with EGL and will be defined later on. EGL is a very important part of OpenGL ES and acts as the interface between the windowing system and OpenGL ES drawing commands. We use it for create drawing surfaces and communicating with the native windows systems. We also use it to find out what surface configurations are available on the desired platform.</p>
<div class="fragment"><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span>ContextFactory <span class="keyword">implements</span> GLSurfaceView.EGLContextFactory</div><div class="line">    {</div><div class="line">        <span class="keyword">public</span> EGLContext createContext(EGL10 egl, EGLDisplay display, EGLConfig eglConfig)</div><div class="line">        {</div><div class="line">            <span class="keyword">final</span> <span class="keywordtype">int</span> EGL_CONTEXT_CLIENT_VERSION = 0x3098;</div><div class="line"></div><div class="line">            <span class="keywordtype">int</span>[] attrib_list = {EGL_CONTEXT_CLIENT_VERSION, 2, EGL10.EGL_NONE };</div><div class="line"></div><div class="line">            EGLContext context = egl.eglCreateContext(display, eglConfig, EGL10.EGL_NO_CONTEXT, attrib_list);</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> context;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> destroyContext(EGL10 egl, EGLDisplay display, EGLContext context)</div><div class="line">        {</div><div class="line">            egl.eglDestroyContext(display,  context);</div><div class="line">        }</div><div class="line">    }</div></div><!-- fragment --><p> This class comes next in the source code and is part of the tutorialView class. This implements an EGLContextFactory class that is defined as part of Android. It is roughly similar to EGLContext on other platforms. An EGLContext is a data structure that is used internally by OpenGL. For the most part you don't need to worry about it. In fact Android hides most of the details from you. All you need to do is define these two functions.</p>
<p>The createContext function as you may of guessed just creates a context for you. It takes in a list of attributes which in this instance only holds one attribute. EGL_CONTEXT_CLIENT_VERSION which you set to the version of OpenGL ES you are using, in this case 2. The EGL10.EGL_NONE is used to signify the end of the list. Once the context is created you just return it. The destroyContext function just deletes the context that is passed to it.</p>
<div class="fragment"><div class="line">    <span class="keyword">protected</span> <span class="keyword">class </span>ConfigChooser <span class="keyword">implements</span> GLSurfaceView.EGLConfigChooser</div><div class="line">    {</div><div class="line">        <span class="keyword">public</span> EGLConfig chooseConfig(EGL10 egl, EGLDisplay display)</div><div class="line">        {</div><div class="line">            <span class="keyword">final</span> <span class="keywordtype">int</span> EGL_OPENGL_ES2_BIT = 4;</div><div class="line">            <span class="keywordtype">int</span>[] <a class="code" href="_thread_sync_8h.html#afca88c51ba67ffba2a4d2979b9d95147">configAttributes</a> =</div><div class="line">            {</div><div class="line">                EGL10.EGL_RED_SIZE, redSize,</div><div class="line">                EGL10.EGL_GREEN_SIZE, greenSize,</div><div class="line">                EGL10.EGL_BLUE_SIZE, blueSize,</div><div class="line">                EGL10.EGL_RENDERABLE_TYPE, EGL_OPENGL_ES2_BIT,</div><div class="line">                EGL10.EGL_SAMPLES, sampleSize,</div><div class="line">                EGL10.EGL_DEPTH_SIZE, depthSize,</div><div class="line">                EGL10.EGL_STENCIL_SIZE, stencilSize,</div><div class="line">                EGL10.EGL_NONE</div><div class="line">            };</div><div class="line"></div><div class="line">            <span class="keywordtype">int</span>[] num_config = <span class="keyword">new</span> <span class="keywordtype">int</span>[1];</div><div class="line">            egl.eglChooseConfig(display, configAttributes, null, 0, num_config);</div><div class="line"></div><div class="line">            <span class="keywordtype">int</span> numConfigs = num_config[0];</div><div class="line"></div><div class="line">            EGLConfig[] configs = <span class="keyword">new</span> EGLConfig[numConfigs];</div><div class="line">            egl.eglChooseConfig(display, configAttributes, configs, numConfigs, num_config);</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> selectConfig(egl, display, configs);</div><div class="line">        }</div></div><!-- fragment --><p> The next class that we need to implement is EGLConfigChooser. This is the class that deals with all of the surface parameters we listed right at the start of the view class. This class needs to implement the function chooseConfig. The first thing we do is create another attribute list that will hold the desired configuration that we want. All of the attributes listed have been discussed at the beginning except EGL_RENDERABLE_TYPE. We need to set this to the interface that we are using. In this case it will be OpenGL ES 2.0.</p>
<p>We then need to get the number of configs that are supported so we call eglChooseConfig with NULL so that it just returns the number of configs available. We then create a new array of EGLConfigs to hold all the configurations that match what we require. Now unfortunately, even though we specify exactly what conditions we want for our surface configuration, EGL will be happy to give you anything that is greater than the configuration you ask for. This may not be desired as we may want a 565 colour space and under its rules it will be able to return you an 8888 configuration.</p>
<p>This means we need to go through all of the configurations to select one which is appropriate. That is the job of the next function selectConfig.</p>
<div class="fragment"><div class="line">        <span class="keyword">public</span> EGLConfig selectConfig(EGL10 egl, EGLDisplay display, EGLConfig[] configs)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">for</span>(EGLConfig config : configs)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">int</span> d = getConfigAttrib(egl, display, config, EGL10.EGL_DEPTH_SIZE, 0);</div><div class="line">                <span class="keywordtype">int</span> s = getConfigAttrib(egl, display, config, EGL10.EGL_GREEN_SIZE, 0);</div><div class="line">                <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a> = getConfigAttrib(egl, display, config, EGL10.EGL_RED_SIZE,0);</div><div class="line">                <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a9cd653b1648845554169fbc3a3f6d37a">g</a> = getConfigAttrib(egl, display, config, EGL10.EGL_GREEN_SIZE, 0);</div><div class="line">                <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a> = getConfigAttrib(egl, display, config, EGL10.EGL_BLUE_SIZE, 0);</div><div class="line">                <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a> = getConfigAttrib(egl, display, config, EGL10.EGL_ALPHA_SIZE, 0);</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (r == redSize &amp;&amp; g == greenSize &amp;&amp; b == blueSize &amp;&amp; a == alphaSize &amp;&amp; d &gt;= depthSize &amp;&amp; s &gt;= stencilSize)</div><div class="line">                    <span class="keywordflow">return</span> config;</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> null;</div><div class="line">        }</div></div><!-- fragment --><p> This function loops through all of the configurations that match or exceed our current specification and then makes sure that our configuration is matched exactly. It does this by calling the function getConfigAttrib which returns the value of a given parameter. It then compares them with their desired value and only returns the configuration if it finds a match. The final function that is part of the ConfigChooser is the getConfigAttrib described earlier.</p>
<div class="fragment"><div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> getConfigAttrib(EGL10 egl, EGLDisplay display, EGLConfig config,</div><div class="line">                <span class="keywordtype">int</span> attribute, <span class="keywordtype">int</span> defaultValue)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (egl.eglGetConfigAttrib(display, config, attribute, value))</div><div class="line">                <span class="keywordflow">return</span> value[0];</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> defaultValue;</div><div class="line">        }</div></div><!-- fragment --><p> This function just calls the EGL Library equivalent and then just returns the value given. Note the keyword value here comes from right at the start of the class it was one of the parameters that we defined. This leads us on to our final class of our view structure, the Renderer class.</p>
<div class="fragment"><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span>Renderer <span class="keyword">implements</span> GLSurfaceView.Renderer</div><div class="line">    {</div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> onDrawFrame(GL10 gl)</div><div class="line">        {</div><div class="line">            NativeLibrary.step();</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> onSurfaceChanged(GL10 gl, <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a9a82cf3caff84cabc4598e2619faac17">width</a>, <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#aa352f2804b9902ac30769c00dde75d5f">height</a>)</div><div class="line">        {</div><div class="line">            NativeLibrary.init(width,height);</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> onSurfaceCreated(GL10 gl, EGLConfig config)</div><div class="line">        {</div><div class="line"></div><div class="line">        }</div><div class="line">    }</div></div><!-- fragment --><p> The Renderer class acts as a basic callback function. We need to implement three different methods. The first, onDrawFrame is called when a new frame has been requested to render. In this case we send control straight into the native side of our application. onSurfaceChanged gets called when your surface has changed. This also gets called when the surface gets created. If you are familiar with standard OpenGL you maybe familiar with some of the callback functions. As onSurfaceChanged gets called when the surface gets created, here we are going to leave onSurfaceCreated blank.</p>
<h1><a class="anchor" id="graphicsSetupNativeLibrary"></a>
NativeLibrary Class</h1>
<p>There is very little change to the interface library. We just need to add a function prototype for the step function, which will be called every frame, and add two parameters to the init function. These two parameters should be the width and the height of the view.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NativeLibrary</div><div class="line">{</div><div class="line">    <span class="keyword">static</span></div><div class="line">    {</div><div class="line">        System.loadLibrary(<span class="stringliteral">&quot;Native&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> native <span class="keywordtype">void</span> init(<span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#a9a82cf3caff84cabc4598e2619faac17">width</a>, <span class="keywordtype">int</span> <a class="code" href="gl2ext_8h.html#aa352f2804b9902ac30769c00dde75d5f">height</a>);</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> native <span class="keywordtype">void</span> step();</div><div class="line">}</div></div><!-- fragment --> <h1><a class="anchor" id="graphicsSetupNativeCode"></a>
Native Code</h1>
<p>Again, very little has changed here. We have just added the step function prototype and then defined the function to print a new message to the Android log. As the Android package name has changed we need to also reflect that in the C Function Names.</p>
<p>Here are the prototypes: </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span></div><div class="line">{</div><div class="line">    JNIEXPORT <span class="keywordtype">void</span> JNICALL <a class="code" href="tutorials_2_graphics_setup_2jni_2_native_8cpp.html#a5ee5a777d1cc9d1a42f54a91859e89e1">Java_com_arm_malideveloper_openglessdk_graphicssetup_NativeLibrary_init</a>(</div><div class="line">            JNIEnv * env, jobject obj, jint <a class="code" href="gl2ext_8h.html#a9a82cf3caff84cabc4598e2619faac17">width</a>, jint <a class="code" href="gl2ext_8h.html#aa352f2804b9902ac30769c00dde75d5f">height</a>);</div><div class="line">    JNIEXPORT <span class="keywordtype">void</span> JNICALL <a class="code" href="tutorials_2_graphics_setup_2jni_2_native_8cpp.html#a18170bb5d138a069b60b19207fd2ed49">Java_com_arm_malideveloper_openglessdk_graphicssetup_NativeLibrary_step</a>(</div><div class="line">            JNIEnv * env, jobject obj);</div><div class="line">};</div></div><!-- fragment --><p> Here are the Definitions: </p><div class="fragment"><div class="line">JNIEXPORT <span class="keywordtype">void</span> JNICALL <a class="code" href="tutorials_2_graphics_setup_2jni_2_native_8cpp.html#a18170bb5d138a069b60b19207fd2ed49">Java_com_arm_malideveloper_openglessdk_graphicssetup_NativeLibrary_step</a>(</div><div class="line">        JNIEnv * env, jobject obj)</div><div class="line">{</div><div class="line">    <span class="comment">/* Sleeping to avoid thrashing the Android log. */</span></div><div class="line">    <a class="code" href="_compute_particles_2jni_2common_2timer_8h.html#a1028b803329409c550b58ea59777368b">sleep</a>(5);</div><div class="line">    <a class="code" href="_astc_textures_8h.html#a5512e59d578a380a441a70256af997d0">LOGI</a>(<span class="stringliteral">&quot;New Frame Ready to be Drawn!!!!&quot;</span>);</div><div class="line">}</div></div><!-- fragment --> <h1><a class="anchor" id="graphicsSetupBuildRun"></a>
Building and Running the Application</h1>
<p>Follow the <a class="el" href="gettingStartedGuide.html">Getting Started Guide</a> from <a class="el" href="gettingStartedGuide.html#gettingStartedGuideBuildingTheSamples">Building Android samples</a> onwards to build and run the application.</p>
<h1><a class="anchor" id="graphicsSetupNextSteps"></a>
Next Steps</h1>
<p>Now move on to making your first <a class="el" href="simpleTriangle.html">Simple Triangle</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">
        <a class="copyright" href="http://www.arm.com/">(C) ARM Ltd. 2017</a>
    </li>
  </ul>
</div>
</body>
</html>
